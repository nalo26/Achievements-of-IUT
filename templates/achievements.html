<head>
    <title>[IUT RPG] {{ achievements[category].name }}</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/navbar.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/sidebar.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/tree.css') }}">
</head>

<body>
    <div class="sidebar">
        {% for a in achievements %}
            <li><a title="{{ a.lore }}" href="/achievements/{{ loop.index-1 }}">{{ a.name }}</a></li>
        {% endfor %}
    </div>
    
    {% include "navbar.html" %}

    <div class="tree-div">

    </div>
    <script>
        var canvas = document.querySelector(".tree-div");
        var tree = document.createElement("div");
        tree.className = "tree";
        canvas.appendChild(tree);
        var achievements = {{ achievements[category].childs | safe }};
        tree_builder(achievements, tree);

        function tree_builder(achievements, parent_node) {
            for(let i in achievements) {
                let a = achievements[i];

                let entry = document.createElement("div");
                entry.className = "entry";

                let label = document.createElement("span");
                label.className = "label";
                let color = getComputedStyle(document.documentElement).getPropertyValue("--difficulty-" + a.difficulty);
                label.style.borderColor = color;
                label.innerHTML = a.name;
                
                entry.appendChild(label);
                parent_node.appendChild(entry);

                if(typeof a.childs !== 'undefined') {
                    let next = document.createElement("div");
                    next.className = "branch";
                    entry.appendChild(next);
                    tree_builder(a.childs, next);
                } //else entry.classList.add("sole");
            }
        }
    </script>
</body>